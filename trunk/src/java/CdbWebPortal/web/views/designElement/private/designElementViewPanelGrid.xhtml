<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:param name="designElementObject" value="#{designElementController.selected}"/>
    <ui:param name="breadcrumb" value="#{designElementController.currentViewId}"/>    
    <ui:param name="breadcrumbObjectId" value="#{designElementObject.id}"/>  
    <p:panelGrid columns="2" styleClass="viewEntityDetails">

        <h:outputLabel for="name" value="Name" styleClass="entityDataEmphasizedLabel"/>
        <p:inplace id="name" editor="#{isEntityWriteable}" toggleable="#{isEntityWriteable}" emptyLabel="-" styleClass="entityDataEmphasizedText">
            <p:ajax event="save" oncomplete="inlineSaveEntity()"/>
            <p:inputText value="#{designElementObject.name}" title="Name" styleClass="entityDataEmphasizedText"/>
        </p:inplace>

        <h:outputLabel for="parentDesign" value="Parent Design" styleClass="entityDataEmphasizedLabel"/>
        <h:outputLink id="parentDesign" value="../design/view.xhtml?id=#{designElementObject.parentDesign.id}&amp;breadcrumb=#{breadcrumb}&amp;breadcrumbObjectId=#{breadcrumbObjectId}" 
                      title="Parent Design: #{designElementObject.parentDesign.name}">
            <h:outputText value="#{designElementObject.parentDesign.name}" styleClass="entityDataEmphasizedText"/>
        </h:outputLink>

        <h:outputLabel for="component" value="Component" styleClass="entityDataEmphasizedLabel"/>
        <h:outputLink id="component" value="../component/view.xhtml?id=#{designElementObject.component.id}&amp;breadcrumb=#{breadcrumb}&amp;breadcrumbObjectId=#{breadcrumbObjectId}" 
                      title="Component: #{componentInstanceObject.component.displayNameWithTypeAndCategory}">
            <h:outputText value="#{designElementObject.component.displayNameWithTypeAndCategory}" styleClass="entityDataEmphasizedText"/>
        </h:outputLink>

        <h:outputLabel for="childDesign" value="Child Design" styleClass="entityDataEmphasizedLabel"/>
        <h:outputLink id="childDesign" value="../design/view.xhtml?id=#{designElementObject.childDesign.id}&amp;breadcrumb=#{breadcrumb}&amp;breadcrumbObjectId=#{breadcrumbObjectId}" 
                      title="Child Design: #{designElementObject.childDesign.name}">
            <h:outputText value="#{designElementObject.childDesign.name}" styleClass="entityDataEmphasizedText"/>
        </h:outputLink>

        <h:outputLabel for="location" value="Location" styleClass="entityDataEmphasizedLabel"/>
        <p:inplace id="location" 
                   editor="#{isEntityWriteable}" 
                   toggleable="#{isEntityWriteable}" 
                   label="#{designElementObject.locationDisplayName}" styleClass="entityDataEmphasizedText">
            <p:ajax event="save" oncomplete="inlineSaveEntity()"/>
            <p:ajax event="cancel" oncomplete="reloadLocation()"/>
            <p:remoteCommand name="reloadLocation"
                     action="#{entityController.reloadCurrent()}"
                     update="location"
                     />
            <p:autoComplete id="designElementLocationDropdown" 
                            value="#{designElementObject.location}" 
                            var="location"
                            converter="locationConverter" 
                            completeMethod="#{designElementController.completeLocation}" 
                            itemLabel="#{location.name}"
                            itemValue="#{location}"
                            valueChangeListener="#{designElementController.selectLocationValueChangeListener}"
                            forceSelection="true"
                            scrollHeight="200"
                            dropdown="true" 
                            styleClass="autocomplete">
                <p:ajax event="valueChange" immediate="true" process="@this"/>
            </p:autoComplete>
            <p:commandButton id="designElementLocationSelectButton" onclick="PF('designElementLocationSelectDialogWidget').show();" 
                             alt="Select" icon="ui-icon-search"
                             styleClass="selectButtonForAutocomplete"
                             immediate="true">
                <f:setPropertyActionListener target="#{designElementController.current}" value="#{designElementObject}"/>
            </p:commandButton>  
        </p:inplace>

        <h:outputLabel for="description" value="Description" styleClass="entityDataLabel"/>
        <p:inplace id="description" 
                   editor="#{isEntityWriteable}" 
                   toggleable="#{isEntityWriteable}" 
                   emptyLabel="-"
                   styleClass="entityDataText">
            <p:ajax event="save" oncomplete="inlineSaveEntity()"/>
            <h:inputTextarea value="#{designElementObject.description}" title="Description" styleClass="entityDataText"/>
        </p:inplace>

        <h:outputLabel for="sortOrder" value="Sort Order" styleClass="entityDataLabel"/>
        <p:inplace id="sortOrder" 
                   editor="#{isEntityWriteable}" 
                   toggleable="#{isEntityWriteable}" 
                   emptyLabel="-"
                   styleClass="entityDataText">
            <p:ajax event="save" oncomplete="inlineSaveEntity()"/>
            <h:inputText value="#{designElementObject.sortOrder}" title="Sort Order" styleClass="entityDataText"/>
        </p:inplace>

    </p:panelGrid>
    
    <ui:include src="designElementLocationSelectDialog.xhtml">
        <ui:param name="updateTarget" value="designElementLocationDropdown"/>
    </ui:include>

    <p:remoteCommand name="inlineSaveEntity"
                     action="#{entityController.inlineUpdate()}"
                     />

</ui:composition>


